<!-- News Section -->
    <section id="news" class="bg-light-gray">
        <div class="container">
          <div class="row">
              <div class="col-lg-12 text-center">
                  <h2 class="section-heading">Actualités</h2>
                  <h3 class="section-subheading text-muted">Mon prochain concert</h3>
              </div>
          </div>
          <div>

            {% capture nowunix %}{{ 'now' | date: '%s' }}{% endcapture %}
            {% assign events = site.events | sort:"date" %}
            {% for event in events %}
              {% capture eventtime %}{{event.date | date: '%s'}}{% endcapture %}
              {% if eventtime > nowunix %}
                {% capture address %}{{ event.address }}{% endcapture %}
                <h2>{{ event.name }}</h2>
                <h3>{{ event.address }}</h3>
                <h3>Début du concert: {{ event.time }}</h3>
                <div id="map"></div>
                {% break %}
              {% endif %}
            {% endfor %}

          </div>
        </div>

        <script type="text/javascript">
          var map = null;
          window.onload = function() {initMap()};
          function initMap() {
              var options = {
                  center: new L.LatLng({{ site.data.map.latitude }}, {{ site.data.map.longitude }}),
                  zoom: {{ site.data.map.zoom }}
                };
              var osmUrl = '{{ site.data.map.osm-url }}',
                  osmAttribution = '{{ site.data.map.osm-attribution }}',
                  osm = new L.TileLayer(osmUrl, {
                      maxZoom: {{ site.data.map.max-zoom }},
                      attribution: osmAttribution
                  });
              var mapLayer = new L.TileLayer(osmUrl);
              this.map = new L.Map('map', options).addLayer(mapLayer);
              locateUser();
          }
          function locateUser(position) {
              fetch('http://api-adresse.data.gouv.fr/search/?q=' + '{{ address }}')
                  .then(function(response) {
                      if (response.ok) {
                          return (response.json());
                      }
                  })
                  .then(function(json) {
                      var place = json.features[0];
                      var marker = L.marker([place.geometry.coordinates[1], place.geometry.coordinates[0]])
                        .addTo(this.map);
                      this.map.setView(
                        [place.geometry.coordinates[1], place.geometry.coordinates[0]],
                        zoom = {{ site.data.map.zoom-in }}
                      );
                  })
                  .catch(function(error) {
                  });
          }
      </script>
    </section>
